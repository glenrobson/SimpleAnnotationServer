<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <ui:composition template="WEB-INF/templates/layout.xhtml">
        <ui:param name="title" value="Manifest Details"></ui:param>
        <ui:param name="path" value="/"></ui:param>
        <ui:define name = "content">
            <main xmlns="http://www.w3.org/1999/xhtml" tabindex="-1" role="main" id="content" class="bs-docs-masthead">
                <div class="container">
                    <c:set var="tManifest" value="#{storeService.getManifestId(param['iiif-content'])}" scope="request" />
                    <h1>IIIF Search Service</h1>
                    <p>A IIIF search service is available for this manifest at the following URL:</p>
                    <ul>
                        <li><a id="search_url" href="search-api/#{user.shortId}/#{tManifest.shortId}/search" data-relative="true"><span data-relative="true">search-api/#{user.shortId}/#{tManifest.shortId}/search</span></a></li>
                    </ul>    
                    <p>You can add this search service to a manifest by manually editing the JSON and adding the search service. This will allow you to search for your annotations using any compatible IIIF viewer like Mirador or the Universal Viewer. To add this search service to your manifest add the following json snippet to your manifest at the top level just after the <code>label</code>:</p>
<pre>
"service": {
    "profile": "http://iiif.io/api/search/0/search",
    "@id": "<span data-relative="true">search-api/#{user.shortId}/#{tManifest.shortId}/search</span>",
    "@context": "http://iiif.io/api/search/0/context.json"
},
</pre>
                <p>For example see this manifest snippet:</p>
<pre>
{
    "@context":"http://iiif.io/api/presentation/2/context.json",
    "@id": "<h:outputText value="#{tManifest.URI}" escape="false" />",
    "@type":"sc:Manifest",
    "label": "<h:outputText value="#{tManifest.label}" escape="false" />",
    "service": {
        "profile": "http://iiif.io/api/search/0/search",
        "@id": <span data-relative="true">search-api/#{user.shortId}/#{tManifest.shortId}/search</span>,
        "@context": "http://iiif.io/api/search/0/context.json"
    },
    "sequences" : [
  ....
</pre>
                <script>
                    var elements = document.querySelectorAll('[data-relative]');
                    for (var i = 0; i &lt; elements.length; i++) {
                        relativeToAbsolute(elements[i]);
                    }
                </script>
                </div> 
            </main>
        </ui:define>
    </ui:composition>
</html>

